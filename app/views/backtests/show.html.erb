<div class="container mt-5">
  <h1>Backtest Results for <%= @backtest.stock.ticker %></h1>
  <p><strong>Start Date:</strong> <%= @backtest.start_date %></p>
  <p><strong>End Date:</strong> <%= @backtest.end_date || @backtest.start_date + 30 %></p>
  <p><strong>Invested Amount:</strong> ₹<%= @result[:invested_amount] %></p>
  <p><strong>Final Portfolio Value:</strong> ₹<%= @result[:portfolio].round(2) %></p>
  <p><strong>Profit/Loss:</strong> ₹<%= @result[:profit_loss].round(2) %></p>
  <p><strong>Final Shares:</strong> <%= @result[:final_shares].round(4) %></p>
  <p><strong>Total Charges:</strong> <%= @result[:charges].round(4) %></p>

  <h2>Transactions</h2>
  <% if @result[:transactions].empty? %>
    <p>No transactions recorded.</p>
  <% else %>
    <table class="table table-striped">
      <thead>
        <tr>
          <th>Date</th>
          <th>Type</th>
          <th>Price</th>
          <th>Quantity</th>
          <th>Amount</th>
        </tr>
      </thead>
      <tbody>
        <% @result[:transactions].each do |txn| %>
          <tr>
            <td><%= txn.date %></td>
            <td><%= txn.transaction_type.capitalize %></td>
            <td>₹<%= txn.price %></td>
            <td><%= txn.quantity.round(4) %></td>
            <td><% if txn.transaction_type == "buy" %>
                ₹<%= txn.amount %></td></td>
              <% else %>
                <strong>₹<%= txn.amount %></td></strong>
              <% end %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  <% end %>
  <%= link_to 'New Backtest', new_backtest_path, class: 'btn btn-primary' %>
</div>
